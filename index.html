<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Attendance M1/14</title>

<style>
body{font-family:sans-serif;padding:20px}
table{border-collapse:collapse;width:100%}
th,td{border:1px solid #666;padding:6px;text-align:center}
.absent{background:#ffcccc}
</style>

</head>

<body>

<h2>üìã ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠ ‡∏°.1/14 English Program</h2>

<p id="summary"></p>

<table id="table"></table>

<br>
<button onclick="exportCSV()">Export CSV</button>

<script>

let students=[
{id:"43620",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏Å‡∏£ ‡∏°‡∏ì‡∏µ‡πÄ‡∏°‡∏∑‡∏≠‡∏á"},
{id:"43643",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏à‡∏ï‡∏∏‡∏û‡∏£ ‡∏Å‡∏•‡πà‡∏≥‡∏û‡∏•"},
{id:"43666",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏ä‡∏±‡∏¢‡∏†‡∏±‡∏ó‡∏£ ‡πÄ‡∏™‡∏ô‡πà‡∏´‡∏≤"},
{id:"43686",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏ì‡∏£‡∏á‡∏Ñ‡πå‡∏ä‡∏ô ‡πÅ‡∏Å‡πâ‡∏ß‡∏°‡∏ì‡∏µ"},
{id:"43688",name:"‡πÄ‡∏î‡πá‡∏Å‡∏£‡∏ä‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏õ‡∏£‡∏Å‡∏£‡∏ì‡πå ‡∏£‡∏±‡∏ï‡∏ô‡∏™‡∏±‡∏à‡∏ò‡∏£‡∏£‡∏°"},
{id:"43709",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏ñ‡∏¥‡∏£‡∏û‡∏∏‡∏ó‡∏ò‡∏¥‡πå ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡πÑ‡∏û‡∏ö‡∏π‡∏•"},
{id:"43720",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏ò‡∏ô‡∏†‡∏±‡∏ó‡∏£ ‡∏ö‡∏∏‡∏ç‡∏°‡∏µ"},
{id:"43741",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏ò‡∏µ‡∏£‡∏†‡∏±‡∏ó‡∏£ ‡πÉ‡∏à‡∏£‡∏∑‡πà‡∏ô"},
{id:"43760",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏õ‡∏†‡∏≤‡∏ß‡∏¥‡∏ô ‡∏û‡∏ö‡∏ö‡πà‡∏≠‡πÄ‡∏á‡∏¥‡∏ô"},
{id:"43800",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡πÇ‡∏û‡∏ä‡∏å‡∏á‡∏Ñ‡πå ‡∏™‡∏∏‡∏Ç‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå"},
{id:"43801",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏†‡∏Ñ‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏Ñ‡∏∏‡πâ‡∏°‡∏ï‡∏±‡∏ß"},
{id:"43809",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏†‡∏π‡∏ö‡∏î‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡∏ä‡∏π‡πÄ‡∏ä‡∏¥‡∏î"},
{id:"43875",name:"‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢‡∏≠‡∏¥‡∏™‡∏£‡∏∞ ‡∏ä‡∏±‡∏¢‡∏ö‡∏£‡∏£‡∏à‡∏á‡πÄ‡∏ß‡∏ä"},
{id:"43881",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏Å‡∏§‡∏ï‡∏¥‡∏ç‡∏î‡∏≤ ‡∏ñ‡∏µ‡∏£‡∏ß‡∏á‡∏®‡πå"},
{id:"43888",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏Å‡∏±‡∏ç‡∏ç‡∏≤‡∏†‡∏±‡∏Ñ ‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ô‡∏¥‡∏ò‡∏¥"},
{id:"43906",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏à‡∏£‡∏£‡∏¢‡∏°‡∏ì‡∏ë‡∏ô‡πå ‡∏ö‡∏∏‡∏ç‡∏â‡πà‡∏≥"},
{id:"43915",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡πÄ‡∏à‡∏ô‡πà‡∏≤‡∏î‡∏≤‡∏ß ‡πÄ‡∏•‡∏ü‡πÄ‡∏ü‡πà"},
{id:"43928",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏ç‡∏≤‡∏ì‡∏¥‡∏ì‡∏µ ‡πÇ‡∏û‡∏ò‡∏¥‡πå‡∏¢‡∏ß‡∏á"},
{id:"43934",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏ê‡∏≤‡∏ô‡∏¥‡∏ï‡∏≤ ‡∏ó‡∏±‡∏®‡∏®‡∏£‡∏µ‡∏©‡∏∞"},
{id:"43936",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏ì‡∏â‡∏±‡∏ï‡∏£ ‡∏õ‡∏¥‡πà‡∏ô‡∏™‡∏∏‡∏Ç"},
{id:"43944",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏ì‡∏£‡∏±‡∏ç‡∏ä‡∏ô‡πå‡∏£‡∏±‡∏ï‡∏ô‡πå ‡∏û‡∏£‡∏∞‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì"},
{id:"43945",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏ì‡∏±‡∏ä‡∏ä‡∏£‡∏µ ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏ï‡∏£‡∏á"},
{id:"43954",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏ì‡∏±‡∏ê‡∏Å‡∏§‡∏ï‡∏≤ ‡∏ó‡πâ‡∏ß‡∏°‡πÇ‡∏Ñ‡∏Å‡∏´‡∏°‡πâ‡∏≠"},
{id:"44000",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏ö‡∏∏‡∏ç‡∏¢‡∏ô‡∏∏‡∏ä ‡∏ö‡∏∏‡∏ç‡∏¢‡∏∑‡∏ô"},
{id:"44031",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏û‡∏•‡∏≠‡∏¢‡∏ô‡∏ß‡∏û‡∏±‡∏ä‡∏£ ‡∏Ñ‡∏µ‡∏£‡∏µ‡∏ß‡∏±‡∏•"},
{id:"44048",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏†‡∏ß‡∏£‡∏±‡∏ç‡∏ä‡∏ô‡πå ‡∏ï‡πà‡∏≠‡∏ß‡∏¥‡∏ß‡∏ß‡∏£‡∏£‡∏ò"},
{id:"44097",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏®‡∏¥‡∏£‡∏¥‡∏ß‡∏µ‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡∏ß‡∏±‡∏ô‡πÄ‡∏ä‡∏µ‡∏¢‡∏á"},
{id:"44098",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏®‡∏∏‡∏†‡∏£‡∏î‡∏≤ ‡∏û‡∏¥‡∏ô‡∏¥‡∏à‡∏°‡∏ô‡∏ï‡∏£‡∏µ"},
{id:"44117",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡∏≠‡∏•‡∏¥‡∏ô ‡∏™‡∏∏‡∏ï‡∏∞‡∏û‡∏±‡∏ô‡∏ò‡πå"},
{id:"44123",name:"‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á‡πÑ‡∏≠‡∏•‡∏î‡∏≤ ‡∏™‡∏¥‡∏á‡∏´‡πå‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå"}
]

students.forEach(s=>{
s.status=""
s.yellow=0
s.score=100
})

function draw(){

let come=0,absent=0

let html=`<tr>
<th>‡πÄ‡∏•‡∏Ç</th><th>‡∏ä‡∏∑‡πà‡∏≠</th>
<th>‡∏°‡∏≤</th><th>‡∏Ç‡∏≤‡∏î</th><th>‡∏™‡∏≤‡∏¢</th>
<th>‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th></tr>`

students.forEach((s,i)=>{

if(s.status=="‡∏°‡∏≤") come++
if(s.status=="‡∏Ç‡∏≤‡∏î") absent++

html+=`
<tr class="${s.status=='‡∏Ç‡∏≤‡∏î'?'absent':''}">
<td>${s.id}</td>
<td>${s.name}</td>

<td><input type="radio" name="s${i}" onchange="set(${i},'‡∏°‡∏≤')" ${s.status=="‡∏°‡∏≤"?"checked":""}></td>
<td><input type="radio" name="s${i}" onchange="set(${i},'‡∏Ç‡∏≤‡∏î')" ${s.status=="‡∏Ç‡∏≤‡∏î"?"checked":""}></td>
<td><input type="radio" name="s${i}" onchange="set(${i},'‡∏™‡∏≤‡∏¢')" ${s.status=="‡∏™‡∏≤‡∏¢"?"checked":""}></td>

<td>${s.yellow}<br><button onclick="yellow(${i})">‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á</button></td>
<td>${s.score}</td>
</tr>`
})

document.getElementById("table").innerHTML=html
document.getElementById("summary").innerHTML=`‚úÖ ‡∏°‡∏≤ ${come} ‡∏Ñ‡∏ô | ‚ùå ‡∏Ç‡∏≤‡∏î ${absent} ‡∏Ñ‡∏ô`
}

function set(i,v){
students[i].status=v
draw()
}

function yellow(i){
students[i].yellow++
students[i].score-=5
draw()
}

function exportCSV(){
let csv="‡πÄ‡∏•‡∏Ç,‡∏ä‡∏∑‡πà‡∏≠,‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞,‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á,‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô\n"
students.forEach(s=>{
csv+=`${s.id},${s.name},${s.status},${s.yellow},${s.score}\n`
})
let blob=new Blob([csv])
let a=document.createElement("a")
a.href=URL.createObjectURL(blob)
a.download="attendance.csv"
a.click()
}

draw()

</script>

</body>
</html>